:root {
  --row-height: 18px;            /* half-hour slot height */
  --font-size: 12px;
  --line: #2b2b2b;
  --line-strong: #3a3a3a;
  --control-height: 32px;        /* compact but readable controls */
  --timecol-width: 76px;
  --grid-pad: 8px;               /* padding around the scrollable grid */
  /* --topbar-height from common.css */         /* compact top bar */

  /* Viewport-aware height variable (resizes with browser UI changes) */
  --vh: 100vh;
}

/* Prefer dynamic viewport units when supported */
@supports (height: 100dvh) { :root { --vh: 100dvh; } }
@supports (height: 100svh) { :root { --vh: 100svh; } }

/* Unified height used by the schedule grid and the entire right column (below the top bar) */
:root { --panels-height: calc(var(--vh) - var(--topbar-height) - 96px); }

/* ───────────────────────── Layout Shell ───────────────────────── */
.two-col {
  display: grid;
  grid-template-columns: minmax(0, 1fr) clamp(320px, 24vw, 520px);
  gap: clamp(12px, 1.2vw, 24px);
  align-items: start;
}

/* Left column = main grid area */
.left-col { min-width: 0; }

/* Right column — sticky panel set */
.right-col {
  position: sticky;
  top: calc(var(--topbar-height) + 6px);
  max-height: var(--panels-height);
  overflow: auto;
  display: grid;
  gap: 12px;
}

/* Grid shell */
.grid {
  height: var(--panels-height);
  margin: 8px 0 0;
  padding: var(--grid-pad);
  box-sizing: border-box;
  isolation: isolate;             /* new stacking context for sticky children */
}

/* The actual scroller sits inside the padded box */
.grid-content {
  position: relative;
  overflow-y: auto;
  overflow-x: hidden;            /* never allow horizontal scrolling */
  height: 100%;
  width: 100%;
  background: #101010;
  border-radius: 12px;
  backface-visibility: hidden;
  transform: translateZ(0);
}

/* Grid table */
.table {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  table-layout: fixed;
  font-size: var(--font-size);
  color: #dcdcdc;
  border-radius: 12px;
  overflow: hidden;
}
.table thead th {
  position: sticky;
  top: 0;
  z-index: 10;
  background: #171717;
  border-bottom: 1px solid var(--line-strong);
  height: 32px;
  text-align: center;
  font-weight: 600;
}
.table .time-col {
  width: var(--timecol-width);
  text-align: right;
  padding-right: 6px;
  color: #a8a8a8;
  background: #141414;
  position: sticky;
  left: 0;
  z-index: 9;
  border-right: 1px solid var(--line-strong);
  font-variant-numeric: tabular-nums;
}

/* Body cells */
.table td, .table th {
  border-bottom: 1px solid var(--line);
  height: var(--row-height);
  padding: 0;
  background: transparent;
}
.cell { position: relative; background-clip: padding-box; }

/* Heatmap fills */
.cell .fill {
  position: absolute;
  inset: 1px;
  border-radius: 4px;
  pointer-events: none;
  opacity: 0.85;
}

/* Hover & selection indicators */
.cell .hover {
  position: absolute;
  inset: 1px;
  border-radius: 4px;
  border: 1px dashed #4f6ad6;
  pointer-events: none;
}

/* NOW marker */
.now-marker {
  position: absolute;
  left: var(--timecol-width);
  right: 0;
  height: 1px;
  background: #e74c3c;
  z-index: 50;
}
.now-marker .bubble {
  position: absolute;
  top: -8px;
  right: 8px;
  padding: 2px 6px;
  font-size: 10px;
  line-height: 1;
  color: #fff;
  background: #e74c3c;
  border-radius: 6px;
  border: 1px solid rgba(255,255,255,0.15);
}

/* Right column panels */
.panel {
  background: #151515;
  border: 1px solid #2a2a2a;
  border-radius: 12px;
  padding: 12px;
}
.panel h3 {
  margin: 0 0 8px;
  font-size: 14px;
}

/* Members list styles */
.member-list { list-style: none; margin: 8px 0 0; padding: 0; max-height: 200px; overflow: auto; }
.member-list li { display: flex; align-items: center; justify-content: space-between; padding: 6px 0; border-bottom: 1px solid #222; }
.member-list li:last-child { border-bottom: none; }

/* Filters */
.field { display: grid; gap: 6px; margin: 8px 0; }
.field-row { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; }
.sort-row { display: grid; grid-template-columns: 1fr; gap: 8px; }

#max-missing, #min-hours, #sort-method, #add-username {
  background: #202020;
  color: #fff;
  border: 1px solid #333;
  border-radius: 8px;
  padding: 6px 8px;
  height: 32px;
}

.add-user { display: flex; gap: 8px; }
.add-user .btn { height: 32px; padding: 0 10px; }

/* Results */
.results { display: grid; gap: 8px; }
.results .slot { background: #1a1a1a; border: 1px solid #2a2a2a; border-radius: 8px; padding: 8px; }

/* One-column fallback on narrow screens */
@media (max-width: 1100px) {
  .two-col { grid-template-columns: 1fr; }
  .right-col { position: static; max-height: none; overflow: visible; }
  .grid { height: auto; min-height: 60vh; }
}

/* ──────────── Filters panel: extra-thin, dark scrollbar ─────────── */
#filters-panel { scrollbar-width: thin; scrollbar-color: #3a3a3a #121212; }
#filters-panel::-webkit-scrollbar { width: 6px; }
#filters-panel::-webkit-scrollbar-track { background: #121212; }
#filters-panel::-webkit-scrollbar-thumb { background: #3a3a3a; border-radius: 8px; }
#filters-panel::-webkit-scrollbar-thumb:hover { background: #4a4a4a; }

/* Protect shared top bar host (Shadow DOM inside) from page-level overrides */
#topbar-root {
  margin: 0 !important;
  padding: 0 !important;
  border: 0 !important;
  position: static !important;
  z-index: auto !important;
  line-height: normal !important;
}
